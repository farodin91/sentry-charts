suite: test deployment-snuba-replacer
templates:
  - configmap-snuba.yaml
  - deployment-snuba-replacer.yaml
tests:
  - it: update image
    template: deployment-snuba-replacer.yaml
    set:
      images.snuba.tag: test
    asserts:
      - matchSnapshot: {}
  - it: update dnsPolicy
    template: deployment-snuba-replacer.yaml
    set:
      dnsPolicy: test
    asserts:
      - matchSnapshot: {}
  - it: update revisionHistoryLimit
    template: deployment-snuba-replacer.yaml
    set:
      revisionHistoryLimit: 3
    asserts:
      - matchSnapshot: {}
  - it: set replicas
    template: deployment-snuba-replacer.yaml
    set:
      snuba.replacer.replicas: 5
    asserts:
      - matchSnapshot: {}
  - it: set podlabels
    template: deployment-snuba-replacer.yaml
    set:
      snuba.replacer.podLabels:
        test: test
    asserts:
      - matchSnapshot: {}
  - it: set sidecars
    template: deployment-snuba-replacer.yaml
    set:
      snuba.replacer.sidecars:
        - name: test
          image: nginx:latest
    asserts:
      - matchSnapshot: {}
  - it: set resources
    template: deployment-snuba-replacer.yaml
    set:
      snuba.replacer.resources:
        limits:
          memory: 64Mi
    asserts:
      - matchSnapshot: {}
  - it: set volumeMounts
    template: deployment-snuba-replacer.yaml
    set:
      snuba.replacer.volumeMounts:
        - mountPath: /etc/bla
          name: bla
    asserts:
      - matchSnapshot: {}